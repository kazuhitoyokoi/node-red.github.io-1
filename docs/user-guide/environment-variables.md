---
layout: docs-user-guide
toc: toc-user-guide.html
title: 環境変数を利用する
slug: 環境変数
---

### ノードのプロパティとして設定する

`${ENV_VAR}`という形式の文字列を値として設定することで、ノードのプロパティに環境変数を設定することができます。
ランタイムがフローを読み込んだとき、
ノードに文字列が渡される前に環境変数の値が代わりに使われます。

これはプロパティがまるごと置換できる場合のみ動作します - 値の一部だけに代入することはできません。
例えば、`CLIENT-${HOST}`を使うことは*できません*。

ノードはそれぞれの編集ダイアログを提供しているため、
全てのプロパティが環境変数の文字列を入力できるようなテキスト入力欄を提供しているわけではありません。
この場合、プロパティを設定するためにフローファイルを直に編集することを考えることができるかもしれません。


### TypedInputウィジェットとして利用する

<div style="width: 222px" class="figure align-right">
  <img src="editor/images/editor-typedInput-envvar-expanded.png" alt="TypedInput Environment Variable">
  <p class="caption">TypedInput環境変数型</p>
</div>


エディタ内で、TypedInputウィジェットは型として「環境変数」を提供することができます。
この型が選択されたとき、この値は以下のように評価されます。

 - `${}`が存在しない場合、値全体を環境変数名として利用します。
   例えば、
   `"FOO"`は`process.env.FOO`の値に置換されます。


 - `${}`が存在する場合、評価結果には対応する環境変数が代用されます:
   例えば、
   `"Hello ${FOO}"`という値で環境変数`FOO`に`World`が設定されている場合、
   この結果は`"Hello World"`という値になります。



### JSONata式

ChangeノードのようなノードからJSONana式の中で`$env`関数を利用することによって、
環境変数にアクセスすることができます。

```javascript
$env('ENV_VAR')
```

### Functionノード

Functionノード内で、
環境変数は`env.get`関数を利用することによってアクセスすることができます:

```javascript
let foo = env.get("FOO");
```

### Built-In Environment Variables

*Since Node-RED 2.2*

Node-RED maintains its own set of environment variables for exposing information about the node itself. This information helps "locate" the node in your [workspace](/docs/user-guide/editor/workspace/index.md). Nodes in your workspace exist as part of a [flow](/docs/user-guide/editor/workspace/flows.md). Likewise, a node may (or may not) be part of a [group](/docs/user-guide/editor/workspace/groups.md). Nodes, flows and groups are each given unique IDs that are generated by Node-RED.

Nodes, flows and groups all support the `name` property, which you can change when [editing properties](/docs/user-guide/editor/workspace/nodes.md#editing-node-properties).

The following environment variables can be used to access this contextual information for the node.

    - `NR_NODE_ID`
    - `NR_NODE_NAME`
    - `NR_GROUP_ID`
    - `NR_GROUP_NAME`
    - `NR_FLOW_ID`
    - `NR_FLOW_NAME`

Note that while the IDs generated by Node-RED are guaranteed to be unique, the names are not. If a node, flow or group is not given a name, then the corresponding environment variable will return an empty string. If a node is not part of a group, its group id environment variable will also return an empty string.

### サブフローインスタンスプロパティ

0.20版以降、サブフローはインスタンスプロパティを設定できます。
これらは環境変数としてサブフロー内に表示され、
サブフローの個々のインスタンスにあわせてカスタマイズすることができます。

例えば、異なる種類のレコードへのアクセスを提供するREST APIがあり、
環境変数を利用してアクセスする必要があるレコードの種類を識別し、
サブフローはそのAPIにアクセスしてレスポンスを処理するように作成することができます。
そして、サブフローの個々のインスタンスをそれらの特定の種類にあわせてカスタマイズすることができます。
